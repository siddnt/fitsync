<%- include('../partials/header') %>

<div class="container py-5">
    <h1 class="mb-4">My Orders</h1>
    
    <% if (orders && orders.length > 0) { %>
        <div class="orders-list">
            <% orders.forEach(order => { %>
                <div class="order-card card mb-4 shadow-sm">
                    <div class="card-header bg-dark d-flex justify-content-between align-items-center">
                        <div>
                            <h5 class="mb-0">Order #<%= order.orderNumber %></h5>
                            <small class="text-muted">Placed on <%= new Date(order.createdAt).toLocaleString() %></small>
                        </div>
                        <div>
                            <span class="badge <%= 
                                order.status === 'Processing' ? 'bg-info' : 
                                order.status === 'Shipped' ? 'bg-primary' : 
                                order.status === 'Delivered' ? 'bg-success' : 
                                'bg-danger' 
                            %>"><%= order.status %></span>
                        </div>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-8">
                                <h6 class="mb-3">Order Items</h6>
                                <div class="order-items">
                                    <% order.orderItems.forEach(item => { %>
                                        <div class="order-item d-flex mb-3">
                                            <div class="order-item-img">
                                                <img src="<%= item.image %>" alt="<%= item.name %>" class="img-thumbnail" width="80">
                                            </div>
                                            <div class="order-item-details ms-3">
                                                <h6 class="mb-1"><%= item.name %></h6>
                                                <p class="mb-1">Quantity: <%= item.quantity %></p>
                                                <p class="mb-0">Price: ₹<%= item.price %> each</p>
                                            </div>
                                        </div>
                                    <% }); %>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="shipping-info mb-4">
                                    <h6 class="mb-2">Shipping Address</h6>
                                    <p class="mb-1"><%= order.shippingAddress.firstName %> <%= order.shippingAddress.lastName %></p>
                                    <p class="mb-1"><%= order.shippingAddress.address %></p>
                                    <p class="mb-1"><%= order.shippingAddress.city %>, <%= order.shippingAddress.state %> <%= order.shippingAddress.zipCode %></p>
                                    <p class="mb-0">Phone: <%= order.shippingAddress.phone %></p>
                                </div>
                                <div class="payment-info">
                                    <h6 class="mb-2">Payment Method</h6>
                                    <p><%= order.paymentMethod %></p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="card-footer bg-dark">
                        <div class="d-flex justify-content-between">
                            <div>
                                <span>Subtotal: ₹<%= order.subtotal %></span>
                                <span class="mx-2">|</span>
                                <span>Tax: ₹<%= order.tax %></span>
                                <span class="mx-2">|</span>
                                <span>Shipping: ₹<%= order.shippingCost %></span>
                            </div>
                            <div>
                                <strong>Total: ₹<%= order.total %></strong>
                            </div>
                        </div>
                    </div>
                </div>
            <% }); %>
        </div>
    <% } else { %>
        <div class="empty-orders text-center py-5">
            <i class="fas fa-shopping-bag fa-4x mb-3 text-muted"></i>
            <h3>You haven't placed any orders yet</h3>
            <p class="text-muted">Your order history will appear here once you place an order.</p>
            <a href="/shop" class="btn btn-primary mt-3">
                <i class="fas fa-store"></i> Shop Now
            </a>
        </div>
    <% } %>
</div>

<style>
.order-card {
    border-radius: 8px;
    overflow: hidden;
}

.order-card .card-header,
.order-card .card-footer {
    color: #fff;
}

.order-items {
    max-height: 300px;
    overflow-y: auto;
}

.empty-orders {
    color: #6c757d;
}

.empty-orders i {
    opacity: 0.5;
}
</style>

<%- include('../partials/footer') %> 